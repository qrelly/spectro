@import ./spectro/variables.sass
@import ./spectro/mixins.sass
@import ./spectro/animations.sass

@keyframes placeholder-pulse
	+placeholder-pulse-animation-keyframes

@keyframes element-pulse
	+element-pulse-animation-keyframes

@font-face
	font-family: 'spectro'
	src: url('../fonts/spectro.eot')

@font-face
	font-family: 'spectro'
	src: url(data:application/x-font-ttf;charset=utf-8;base64,AAEAAAALAIAAAwAwT1MvMg8SAwkAAAC8AAAAYGNtYXAaVsyRAAABHAAAAFRnYXNwAAAAEAAAAXAAAAAIZ2x5ZtjMNTUAAAF4AAAH/GhlYWQGQNtPAAAJdAAAADZoaGVhB20D0AAACawAAAAkaG10eDIACM8AAAnQAAAAPGxvY2ELLg02AAAKDAAAACBtYXhwABwAjQAACiwAAAAgbmFtZbFiIhMAAApMAAABhnBvc3QAAwAAAAAL1AAAACAAAwPVAZAABQAAApkCzAAAAI8CmQLMAAAB6wAzAQkAAAAAAAAAAAAAAAAAAAABEAAAAAAAAAAAAAAAAAAAAABAAADmCgPA/8AAQAPAAEAAAAABAAAAAAAAAAAAAAAgAAAAAAADAAAAAwAAABwAAQADAAAAHAADAAEAAAAcAAQAOAAAAAoACAACAAIAAQAg5gr//f//AAAAAAAg5gD//f//AAH/4xoEAAMAAQAAAAAAAAAAAAAAAQAB//8ADwABAAAAAAAAAAAAAgAANzkBAAAAAAEAAAAAAAAAAAACAAA3OQEAAAAAAQAAAAAAAAAAAAIAADc5AQAAAAAMANUA1QMrAoAABAAJAA4AEwAYAB0AIgAnACwAMQA2ADsAAAEjNTMVKwE1MxUrATUzFSsBNTMVBSM1MxUrATUzFSsBNTMVKwE1MxUFIzUzFSsBNTMVKwE1MxUrATUzFQMrVlarVVWrVVWqVlYCAFZWq1VVq1VVqlZWAgBWVqtVVatVVapWVgIrVVVVVVVVVVWrVVVVVVVVVVWrVlZWVlZWVlYAAAYBAACAAysC1QAMABEAFQAaAB8AJAAAATUjFSMVMxEhETM1IxMhESERATUhFQUzESMROwERIxE7AREjEQJVgNVVAYBW1lb+1QEr/oAB1f6rKipVKytVKysCqyoqgP5VAauA/gABgP6AAaorK1X+1QEr/tUBK/7VASsAAAAKAQAAqwMAAqsADAAZAB4AIwAoAC0AMgA3ADwAQQAAJSImNTQ2MzIWFRQGIxEiBhUUFjMyNjU0JiMnMxUjNREzFSM1JzMVIzUhMxUjNTcXByc3ARcHJzcTFwcnNwEXByc3AgRIZ2dISWZmSSU0NCUlNTUlL1ZWVlbVZmYBmmZmAT06PDn+xzw5PToJMzwzPAEzOj05PPhmSElmZklIZgEINSUlNDQlJTWrZ2f+ZmZmxFVVVVWtPDo9Of7HPDo8OgEzMzwzPP7NOjw6PAADAKv/SwNgAe8ACwAQACMAACUnBycHFwcXNxc3JyUhFSE1JSM3MxMjDwEjNyEHIzcnIwMzBwNgHVhZHVlZHVlYHVj9owGA/oABfdkIRlV7DxMyHwG+HjETDHlWRwgYHVhYHVhYHVhYHVgVKio8JgGSD1iNjVgP/m4mAAAAAQFk/94CmgH3AB0AAAUjNz4BNxMuAScuASc3MwcOAQcOAQcDHgEXHgEXBwIpxQQRIRBgCA4HBw4IBsQECBAJCREHYAcQBwgNBgQiFgcJAwHHAgQCAwUDFhYDBQMCBAL+OQIEAgIGAxYAAAAAAwEQ/9kC1wH8AFQAbwCKAAAFNT4BNz4BMxEuAScuASc1MzI2Nz4BMzIWFx4BFx4BFx4BFRQGBw4BBw4BBw4BBxUeARceARceARceARUUBgcOAQcOAQcOASMiJiMiJiciJiMmIisBEzoBNz4BNz4BNz4BNTQmJy4BIyoBByIGBxUzFzI2Nz4BNTQmJy4BJy4BJy4BKwEVHgEXHgEzARAIDwgJEAcHEQgJDwd8DhwNDR4REiQREh4ODRYICAgEBQQNBwgTCgsXDAwZDQwXCgoQBgcGCQoJGQ8QIxQUKhUIEgkKEwoJEwkJDwZcxgcNBgcMBg8YCQoJDQ0MIRQIDwYGCwUYIhgmDg4OBQQFDQgIEwsLGQ0oBQsGBhIMIh0ECAMDBAGzAgQDAwYEHQIBAQEDAgMKBwYUDA0gEw0XCgsSCAgOBQYHAwMBBgQEDQgIFAwMHRAVJA8PGAoJDgUEBQEBAQEBASoBAQEBBhMNDR0QGSMMCwsBAQG//Q8ODicXDxgJCg8FBggCAgLFAgEBAQEAAAMAVf+1A6sCNQAEAEUASgAAExEhESEFFAYHDgEVERQWFx4BHQEjNTQ2Nz4BNRE3IwcDIwMnIwcRFBYXHgEdASM1NDY3PgE1ETQmJy4BPQEzExczNxMzFTczESMRVQLW/SoCgA0HBw8PCAcMqg0IBw4OBhmeE5YcBwUOCAcOgA0IBw8OCAgNkYYaARqKf4BWVgI1/YACgFIDBQMCBAL+OAIDAgIGAxYWAwYCAgQCAVlTTv55AYNSU/6nAgQCAgYDFhYDBgIDBAIBxgIEAgMFAyj+ok1PAVwoUv2AAoAAAAAABgCAAAADgANNAAkAFQAhACUAKgAvAAABNQcXNxUjFTM1ESM3NSMVIzUzFQczESM1MzUjNyM1MwczASEVIQUhFSE1ESEVITUBAHQTNlWrqn9AK5ZXV6uAfVVYqFVYAlX+AAIA/gACAP4AAgD+AAKAzTomG4grK/6rsSQrVlx6/qsrKoArgAKAVdZVVf7WVlYABgCAACsDgAMrAAMACAANABoAJwA0AAABIRUhBSEVITURIRUhNQMUBiMiJjU0NjMyFhURFAYjIiY1NDYzMhYVERQGIyImNTQ2MzIWFQOA/gACAP4AAgD+AAIA/gBVMiQjMjIjJDIyJCMyMiMkMjIkIzIyIyQyAwBV1lVV/tZWVgIqIzIyIyQyMiT+1iQyMiQjMjIj/tUjMjIjIzIyIwAAAAYATgArA4ADKgADAAgADQASAC8ANAAAASEVIQUhFSE1BSEVITUVIRUhNRMiJicuAScuAScuATU0Njc+ATc+ATc+ATsBESM1NzMRIxEDgP4AAgD+AAIA/gD/AAMA/QADAP0AIgkRBwgNBgYIAwQDBAQDCgcHEAoJFQsqPGc8PAKAVVZVVapWVqtVVQHZBAUEDAcIEAoJFAoKEwoJEQcHDAQEBf5X2NH+VwGpAAACATgAAALcAbsAGAAxAAAlJjQ/ATYyFwcmIg8BBhQXFjI/ARcHBiInARYUDwEGIic3FjI/ATY0JyYiDwEnNzYyFwE4JSVbJWomHhlHGVsZGRlHGVseWyVqJgGkJSVbJWslHhlHGVoZGRlGGVseWiZqJgAmaiVbJSUeGRlbGUcYGRlaHlslJQG7JmolWyUlHhkZWxlGGRkZWh5bJSUAAAAAAQAAAAEAAEERqSlfDzz1AAsEAAAAAADRu0vdAAAAANG7S90AAP9LA6sDTQAAAAgAAgAAAAAAAAABAAADwP/AAAAEAAAAAAADqwABAAAAAAAAAAAAAAAAAAAADwQAAAAAAAAAAAAAAAIAAAAEAADVBAABAAQAAQAEAACrBAABZAQAARAEAABVBAAAgAQAAIAEAABOBAABOAAAAAAACgAUAB4AcACuARQBUgGIAlACwAMIA1gDrgP+AAEAAAAPAIsADAAAAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAOAK4AAQAAAAAAAQAHAAAAAQAAAAAAAgAHAGAAAQAAAAAAAwAHADYAAQAAAAAABAAHAHUAAQAAAAAABQALABUAAQAAAAAABgAHAEsAAQAAAAAACgAaAIoAAwABBAkAAQAOAAcAAwABBAkAAgAOAGcAAwABBAkAAwAOAD0AAwABBAkABAAOAHwAAwABBAkABQAWACAAAwABBAkABgAOAFIAAwABBAkACgA0AKRzcGVjdHJvAHMAcABlAGMAdAByAG9WZXJzaW9uIDEuMABWAGUAcgBzAGkAbwBuACAAMQAuADBzcGVjdHJvAHMAcABlAGMAdAByAG9zcGVjdHJvAHMAcABlAGMAdAByAG9SZWd1bGFyAFIAZQBnAHUAbABhAHJzcGVjdHJvAHMAcABlAGMAdAByAG9Gb250IGdlbmVyYXRlZCBieSBJY29Nb29uLgBGAG8AbgB0ACAAZwBlAG4AZQByAGEAdABlAGQAIABiAHkAIABJAGMAbwBNAG8AbwBuAC4AAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA) format('truetype')
	font-weight: normal
	font-style: normal

.spectro

	// Icons
	&-icon
		font-smoothing: antialiased
		font-family: 'spectro'
		text-transform: none
		font-variant: normal
		font-weight: normal
		font-style: normal
		font-size: 24px
		line-height: 1
		speak: none

	// Common
	&-hidden
		display: none

	&-label
		color: lighten($color-text, 20%)
		padding: 4px

	&-input
		transition: color $animation-speed-default ease, border-color $animation-speed-default ease
		border: $border-width solid $color-input-border
		background-color: $color-input-background
		box-sizing: border-box
		border-radius: 4px
		color: $color-text
		padding: 4px 6px
		font: inherit
		outline: none
		width: 100%

		&:active,
		&:focus
			border-color: $color-primary

	&-button
		transition: box-shadow $animation-speed-default ease, border-color $animation-speed-default ease
		border: 1px solid darken($color-background-primary, 10%)
		background-color: $color-background-primary
		border-radius: $border-width
		padding: $border-width * 3
		box-sizing: border-box
		color: $color-text
		position: relative
		cursor: pointer
		outline: none
		margin: 3px;

		&:hover
			+helper-box-shadow

			border-color: darken($color-background-primary, 25%)
			z-index: 3

		&--active,
		&:active
			+helper-box-shadow-insert

			background-color: $color-primary
			color: $color-background-primary
			border-color: $color-primary

	// Document related
	&--dragged body
		cursor: move
		cursor: grabbing

	&--dragged &-controls
		display: none
	
	// Element related
	&-element
		transition: box-shadow $animation-speed-default ease, opacity $animation-speed-default ease
		box-shadow: 0 0 0 $border-width fade-out($color-primary, 1)

		&:empty:before //&:blank:before
			font-family: Arial, Helvetica, sans-serif
			content: attr(aria-label)
			color: rgba(0, 0, 0, .4)

		&--hover,
		&--active,
		&[aria-grabbed="true"]
			box-shadow: 0 0 0 $border-width $color-primary
			//outline: $border-width solid $color-primary
			border-radius: 4px
			outline: none

		&[aria-grabbed="true"]
			animation: placeholder-pulse $animation-speed-long infinite

		&--hover[contenteditable="true"]:empty
			&:after
				border-color: $color-primary

		&--active
			animation: element-pulse $animation-speed-long infinite

			&[contenteditable='true']
				&:focus
					cursor: text

				&:empty:after
					transition: border-color $animation-speed-default ease
					border: none

		&--removed
			opacity: 0
			clip: rect(0, 0, 0)
			clip: rect(0, 0, 0, 0)

		&--invalid
			background-color: rgba(255, 0, 0, .1)
			cursor: not-allowed

	// Helpers related
	&--enabled &-helper
		opacity: 1

	&-helper
		transition: box-shadow $animation-speed-default ease, transform $animation-speed-default ease, opacity $animation-speed-default ease
		font: 14px Arial, Helvetica, sans-serif
		position: fixed
		opacity: 1

	// View / edit modes switcher
	&--enabled &-switcher
		+helper-box-shadow

		background-color: $color-background-primary

	&-switcher
		transition: box-shadow $animation-speed-default ease
		line-height: $controls-height
		height: $controls-height
		user-select: none
		width: 200px
		z-index: 999
		right: 0
		top: 0

		&__component
			text-align: center

			&__input
				display: none

			&__label
				color: $color-text
				cursor: pointer
				padding: $border-width

				&:hover
					color: $color-primary

			#spectro-mode-edit:checked ~ &__label[for='spectro-mode-edit'],
			#spectro-mode-view:checked ~ &__label[for='spectro-mode-view']
				color: lighten($color-text, 20%)
				cursor: default

			#spectro-mode-edit:checked ~ &__control
				border-color: $color-primary

			#spectro-mode-edit:checked ~ &__control &__control__bullet
				background-color: $color-primary
				margin-left: 0
				left: $border-width

			&__control
				$control-color: fade-out($color-text, .6)

				transition: border-color $animation-speed-default ease
				border: $border-width solid $control-color
				vertical-align: middle
				display: inline-block
				border-radius: 20px
				position: relative
				overflow: hidden
				cursor: default
				height: inherit
				color: $color-text
				padding: 0 10px
				height: 14px
				width: 20px
				top: -1px

				&__bullet
					transition: background-color $animation-speed-default ease, left $animation-speed-default ease, margin-left $animation-speed-default ease
					background: $control-color
					border-radius: 14px
					margin-left: -14px
					position: absolute
					display: block
					height: 12px
					width: 12px
					left: 100%
					top: 1px

	// Breadcrumbs set
	&--enabled &-breadcrumbs
		+helper-box-shadow

		background-color: $color-background-primary

	&-breadcrumbs
		border-bottom-right-radius: 4px
		user-select: none
		line-height: $controls-height
		height: $controls-height
		z-index: 998
		left: 0
		top: 0

		&__list
			list-style: none
			padding: 0 10px
			margin: 0

			&__item
				display: inline-block
				color: $color-text
				cursor: pointer
				outline: none

				&:first-child:before
					display: none

				&:last-child
					color: $color-primary
					font-weight: bold
					cursor: default

				&:before
					border: 1px solid lighten($color-text, 50%)
					transform: rotate(45deg)
					display: inline-block
					border-bottom: none
					border-left: none
					position: relative
					cursor: default
					margin: 0 8px 0 5px
					content: ''
					height: 6px
					width: 6px
					top: -1px

				&:hover
					color: $color-primary

					& span
						background-color: fade-out($color-background-primary, .4)

	// Key tab panel set
	&-panelset
		box-sizing: border-box
		padding-top: $controls-height
		color: $color-text
		width: 200px
		z-index: 997
		opacity: 0
		right: 0
		top: 0

		// Tab content styling
		&__list
			list-style: none
			padding: 0
			margin: 0

			&__item
				display: block

				&[draggable="true"]
					$item-width: 84px

					text-overflow: ellipsis
					white-space: nowrap
					overflow: hidden
					margin: 0
					margin-top: 4px
					display: block
					padding: 5px
					cursor: move
					cursor: grab
					float: left
					height: $item-width * .75
					width: $item-width

					&:nth-child(1),
					&:nth-child(2)
						margin-top: 0

					&:nth-child(even)
						margin-left: 4px

					&:hover
						+helper-box-shadow

						border-color: darken($color-background-primary, 20%)

		&__input
			display: none

		// Default state
		&__tab
			&__label
				text-transform: uppercase
				color: $color-primary
				letter-spacing: 1px
				font-weight: normal
				user-select: none
				cursor: pointer
				font-size: 11px
				display: block
				padding: 15px
				margin: 0

				&:hover
					background-color: darken($color-background-primary, 3%)

			&__contents
				+helper-box-shadow

				transition: height $animation-speed-default ease, padding-top $animation-speed-default ease, padding-bottom $animation-speed-default ease
				background-color: $color-background-primary
				box-sizing: border-box
				position: relative
				border-radius: 3px
				overflow-y: hidden
				overflow-x: hidden
				display: block
				padding: 0
				height: 0

				// Scrollbar is too thick on windows
				&::-webkit-scrollbar
					width: 6px

				&::-webkit-scrollbar-track
					border-radius: 10px

				&::-webkit-scrollbar-thumb
					background-color: rgba(0, 0, 0, .2)
					border-radius: 10px

		// Active state
		&__input:checked + &__tab
			background-color: $color-primary
			padding-bottom: $border-width

		&__input:checked + &__tab &__tab__label
			transition: none
			background-color: transparent
			cursor: default
			color: white

		&__input:checked + &__tab &__tab__contents
			overflow-y: auto
			margin: 0 $border-width
			padding: 10px
			height: auto

	// Inline-text popover panel
	&-popover
		+helper-box-shadow

		transition: transform $animation-speed-default ease, opacity $animation-speed-default ease
		background-color: rgba(0, 0, 0, .85)
		transform: scale(0)
		position: absolute
		border-radius: 4px
		user-select: none
		margin-top: -42px
		z-index: 998
		opacity: 0

		&--active
			transform-origin: 50% 100%
			transform: scale(1)
			opacity: 1

		&__list
			vertical-align: middle
			list-style: none
			height: 36px
			padding: 0
			margin: 0

			&:after
				border-color: fade-out($color-background-primary, 1)
				border: solid transparent
				pointer-events: none
				position: absolute
				content: ''
				top: 100%
				left: 50%
				height: 0
				width: 0

			&:after
				border-top-color: rgba(0, 0, 0, .85)
				border-width: 10px
				margin-left: -10px

			&__item
				transition: color $animation-speed-default ease
				border-radius: $border-width
				display: inline-block
				height: inherit
				cursor: pointer
				padding: 0 8px
				color: white

				input[type='checkbox']:checked ~ .spectro-icon
					color: $color-primary

	// Placeholder insertion line
	&-placeholder
		$arrow-size: 6px

		box-shadow: none
		pointer-events: none
		text-align: center
		position: absolute
		user-select: none
		display: none

		&--active
			display: block

		&__line
			animation: placeholder-pulse $animation-speed-long infinite
			background: $color-primary
			display: block
			border: none
			padding: 0
			margin: 0

			&:before,
			&:after
				border: solid rgba(66, 129, 244, 0)
				border-width: $arrow-size
				position: absolute
				content: ''
				height: 0
				width: 0

		&--vertical &__line
			width: $border-width
			height: 100%

			&:before,
			&:after
				margin-left: -1 * $arrow-size

			&:before
				border-top-color: $color-primary
				top: 0

			&:after
				border-bottom-color: $color-primary
				margin-top: -12px
				top: 100%

		&--horizontal &__line
			height: $border-width
			width: 100%

			&:before,
			&:after
				margin-top: -1 * $arrow-size
				top: 50%

			&:before
				border-left-color: $color-primary
				left: 0

			&:after
				border-right-color: $color-primary
				right: 0

	// Control tools
	&-controls
		$safe-zone: 30px

		transition: opacity $animation-speed-default ease
		visibility: hidden
		position: absolute
		margin-top: -1 * $safe-zone
		user-select: none
		padding-top: $safe-zone
		z-index: 991
		opacity: 0

		&--active
			visibility: visible
			opacity: 1

		&--active &__toolbar
			top: 0

		&__toolbar
			transition: top $animation-speed-default ease
			position: relative
			list-style: none
			height: inherit
			width: inherit
			padding: 0
			margin: 0
			top: -100%

			&__tool
				+helper-box-shadow
				
				border: $border-width solid $color-primary
				background: $color-background-primary
				background-position: 50% 50%
				background-repeat: no-repeat
				box-sizing: border-box
				border-radius: 4px
				position: absolute
				text-align: center
				min-width: 24px
				display: block
				padding: 0 6px
				height: 24px
				top: -14px

				&--label,
				&--remove
					cursor: pointer
					
					&:hover
						background-color: darken($color-background-primary, 5%)

				&--label
					background-repeat: no-repeat
					background-position: 2px 50%
					text-transform: uppercase
					color: $color-primary
					letter-spacing: 1px
					line-height: 20px
					font-size: 80%
					left: -8px
					z-index: 9

				&--handle
					background-image: url('../../assets/icon-move.svg')
					background-repeat: no-repeat
					margin-left: -30px
					cursor: move
					cursor: grab
					width: 60px
					left: 50%

				&--remove
					transition: background-color $animation-speed-default ease
					background-image: url('../../assets/icon-remove.svg')
					text-align: center
					right: -8px
					width: 21px
					padding: 0
